= üß± Docs-as-Code CI (docs-ci.yml)
:toc:
:toclevels: 2

== üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

Workflow `docs-ci.yml` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
* Markdown
* AsciiDoc
* OpenAPI (`.yaml`, `.yml`)
* –°—Ç–∏–ª—å –∏ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è (Vale)

CI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º Pull Request –∏ push –≤ `main`.

== ‚öôÔ∏è –ü–æ–≤–µ–¥–µ–Ω–∏–µ

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ–∂–∏–º | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|--------|-----------|
| `push` –≤ –≤–µ—Ç–∫—É `main` | **Strict** | –û—à–∏–±–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Å–±–æ—Ä–∫—É |
| `pull_request` | **Soft** | –û—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ PR, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Å–ª–∏—è–Ω–∏–µ |

== üß∞ –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞

| –≠—Ç–∞–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----------|
| üß≠ Checkout repository | –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ CI –æ–∫—Ä—É–∂–µ–Ω–∏–µ |
| üß∞ Build docs-cli image | –°–æ–±–∏—Ä–∞–µ—Ç Docker-–æ–±—Ä–∞–∑ —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ª–∏–Ω—Ç–µ—Ä–∞–º–∏ |
| üöÄ Run Docs-as-Code Validation | –ó–∞–ø—É—Å–∫–∞–µ—Ç `.repo/ci/scripts/run-linters.sh` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| üìé Upload Linter Reports | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å –ª–æ–≥–∞–º–∏ |
| üí¨ Comment Summary in PR | –ü—É–±–ª–∏–∫—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä—è–º–æ –≤ Pull Request |

== üß± –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

[source,text]
----
.repo/
 ‚îú‚îÄ‚îÄ ci/
 ‚îÇ   ‚îú‚îÄ‚îÄ workflows/docs-ci.yml
 ‚îÇ   ‚îî‚îÄ‚îÄ scripts/run-linters.sh
 ‚îî‚îÄ‚îÄ config/
     ‚îú‚îÄ‚îÄ .vale.ini
     ‚îú‚îÄ‚îÄ .spectral.yaml
     ‚îú‚îÄ‚îÄ .markdownlint-cli2.jsonc
     ‚îî‚îÄ‚îÄ .vale/styles/
----

== üöÄ –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é

–ï—Å–ª–∏ workflow –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

1. –û—Ç–∫—Ä–æ–π –≤–∫–ª–∞–¥–∫—É **Actions** –≤ GitHub.
2. –ù–∞–π–¥–∏ **Docs-as-Code CI**.
3. –ù–∞–∂–º–∏ **Run workflow** –∏ –≤—ã–±–µ—Ä–∏ –≤–µ—Ç–∫—É `main`.

== üß© –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ñ–∞–π–ª—ã

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ª–∏–Ω—Ç–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (`git diff origin/main...HEAD`),  
—á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –±–æ–ª—å—à–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.

== üßæ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏

* –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (`artifacts/`)
* PR-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - –°–≤–æ–¥–∫—É –æ—à–∏–±–æ–∫/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
  - –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ (Soft / Strict)
  - –ü–µ—Ä–≤—ã–µ 200 —Å—Ç—Ä–æ–∫ –∏–∑ –∫–∞–∂–¥–æ–≥–æ –ª–æ–≥–∞

== üí° –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

[source,yaml]
----
- name: üöÄ Run Docs-as-Code Validation
  run: |
    docker run --rm -v "$PWD":/work -w /work docs-cli:ci \
      bash .repo/ci/scripts/run-linters.sh
----

== üìà –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏–Ω—Ç–µ—Ä–æ–≤ (Yamllint, JSON Schema)
* –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–æ–≤ –≤ Confluence –∏–ª–∏ Slack
* –ü—Ä–∏–≤—è–∑–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∫ Jira-—Ç–∞—Å–∫–∞–º

== üß† –†–µ–∑—é–º–µ

‚úÖ –ï–¥–∏–Ω—ã–π CI –¥–ª—è –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ PR  
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å  
‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Docker –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π
